url,repository_url,labels_url,comments_url,events_url,html_url,id,node_id,number,title,user,labels,state,locked,assignee,assignees,milestone,comments,created_at,updated_at,closed_at,author_association,active_lock_reason,draft,pull_request,body,reactions,timeline_url,performed_via_github_app
https://api.github.com/repos/pandas-dev/pandas/issues/45817,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45817/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45817/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45817/events,https://github.com/pandas-dev/pandas/pull/45817,1123793307,PR_kwDOAA0YD84yD_fc,45817,"REF: avoid ravel/reshape in astype_nansafe, ndarray_to_mgr","{'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}",[],open,False,,[],,0,2022-02-04T04:20:30Z,2022-02-04T04:20:30Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/45817', 'html_url': 'https://github.com/pandas-dev/pandas/pull/45817', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/45817.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/45817.patch', 'merged_at': None}","- [ ] closes #xxxx (Replace xxxx with the Github issue number)
- [ ] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [ ] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [ ] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45817/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45817/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45816,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45816/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45816/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45816/events,https://github.com/pandas-dev/pandas/issues/45816,1123783951,I_kwDOAA0YD85C-5UP,45816,BUG: df created with `columns` takes exceedingly long time for `sum()`,"{'login': 'nirandaperera', 'id': 5582709, 'node_id': 'MDQ6VXNlcjU1ODI3MDk=', 'avatar_url': 'https://avatars.githubusercontent.com/u/5582709?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/nirandaperera', 'html_url': 'https://github.com/nirandaperera', 'followers_url': 'https://api.github.com/users/nirandaperera/followers', 'following_url': 'https://api.github.com/users/nirandaperera/following{/other_user}', 'gists_url': 'https://api.github.com/users/nirandaperera/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/nirandaperera/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/nirandaperera/subscriptions', 'organizations_url': 'https://api.github.com/users/nirandaperera/orgs', 'repos_url': 'https://api.github.com/users/nirandaperera/repos', 'events_url': 'https://api.github.com/users/nirandaperera/events{/privacy}', 'received_events_url': 'https://api.github.com/users/nirandaperera/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,3,2022-02-04T04:01:36Z,2022-02-04T06:06:36Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
import pandas as pd 
import numpy as np
from numpy.random import default_rng
import time

rng = default_rng()

r = 1000000000
data = rng.integers(0, r, size=(r, 2))
df = pd.DataFrame(data).add_prefix(""col"")

t1 = time.time()
df.sum()
t2 = time.time()
print((t2-t1)*1000)

df = pd.DataFrame(data, columns=[""col0"", ""col1""])
t1 = time.time()
df.sum()
t2 = time.time()
print((t2-t1)*1000)
```


### Issue Description

Ref: example. 
I'm creating a df from a numpy array (10^9, 2) and then call `df.sum()`.
When I create df from, `df = pd.DataFrame(data).add_prefix(""col"")` it takes **1502ms** for the `df.sum()`
But, 
When I create df from, `df = pd.DataFrame(data, columns=[""col0"", ""col1""])` it takes **11979ms** for the `df.sum()`! :astonished: 

Why would there be such a drastic timing difference?

### Expected Behavior

Both cases should take similar times

### Installed Versions

<details>
> pd.show_versions() 
Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
  File ""******/.conda/envs/cylon_dev/lib/python3.8/site-packages/pandas/util/_print_versions.py"", line 109, in show_versions
    deps = _get_dependency_info()
  File ""******/.conda/envs/cylon_dev/lib/python3.8/site-packages/pandas/util/_print_versions.py"", line 88, in _get_dependency_info
    mod = import_optional_dependency(modname, errors=""ignore"")
  File ""******/.conda/envs/cylon_dev/lib/python3.8/site-packages/pandas/compat/_optional.py"", line 126, in import_optional_dependency
    module = importlib.import_module(name)
  File ""******/.conda/envs/cylon_dev/lib/python3.8/importlib/__init__.py"", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File ""<frozen importlib._bootstrap>"", line 1014, in _gcd_import
  File ""<frozen importlib._bootstrap>"", line 991, in _find_and_load
  File ""<frozen importlib._bootstrap>"", line 975, in _find_and_load_unlocked
  File ""<frozen importlib._bootstrap>"", line 671, in _load_unlocked
  File ""<frozen importlib._bootstrap_external>"", line 843, in exec_module
  File ""<frozen importlib._bootstrap>"", line 219, in _call_with_frames_removed
  File ""******/.conda/envs/cylon_dev/lib/python3.8/site-packages/setuptools/__init__.py"", line 8, in <module>
    import _distutils_hack.override  # noqa: F401
  File ""******/.conda/envs/cylon_dev/lib/python3.8/site-packages/_distutils_hack/override.py"", line 1, in <module>
    __import__('_distutils_hack').do_override()
  File ""******/.conda/envs/cylon_dev/lib/python3.8/site-packages/_distutils_hack/__init__.py"", line 71, in do_override
    ensure_local_distutils()
  File ""******/.conda/envs/cylon_dev/lib/python3.8/site-packages/_distutils_hack/__init__.py"", line 59, in ensure_local_distutils
    assert '_distutils' in core.__file__, core.__file__
AssertionError: ******/.conda/envs/cylon_dev/lib/python3.8/distutils/core.py

> pd.__version__
'1.4.0'

</details>


","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45816/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45816/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45815,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45815/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45815/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45815/events,https://github.com/pandas-dev/pandas/issues/45815,1123744958,I_kwDOAA0YD85C-vy-,45815,BUG: ,"{'login': 'AlbertUlysses', 'id': 47486070, 'node_id': 'MDQ6VXNlcjQ3NDg2MDcw', 'avatar_url': 'https://avatars.githubusercontent.com/u/47486070?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/AlbertUlysses', 'html_url': 'https://github.com/AlbertUlysses', 'followers_url': 'https://api.github.com/users/AlbertUlysses/followers', 'following_url': 'https://api.github.com/users/AlbertUlysses/following{/other_user}', 'gists_url': 'https://api.github.com/users/AlbertUlysses/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/AlbertUlysses/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/AlbertUlysses/subscriptions', 'organizations_url': 'https://api.github.com/users/AlbertUlysses/orgs', 'repos_url': 'https://api.github.com/users/AlbertUlysses/repos', 'events_url': 'https://api.github.com/users/AlbertUlysses/events{/privacy}', 'received_events_url': 'https://api.github.com/users/AlbertUlysses/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,1,2022-02-04T02:24:54Z,2022-02-04T05:10:43Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
>>> import pandas as pd
>>> data_frame = pd.read_csv('file.csv')
>>> cols_ = ['entityIdentifierLocal']
data_frame.to_parquet('datasets/',partitions_cols=cols_)
```



### Issue Description

When using the code given above, the return error given is wrong.
The error indicates that the local file had an issue; however, I put ""partitions_cols"" instead of ""partition_cols."" I left an ""s"" in by accident.
Error:
```
ile ""<stdin>"", line 1, in <module>
 File ""/Users/Documents/repos/test/.venv/lib/python3.8/site-packages/pandas/util/_decorators.py"", line 207, in wrapper
  return func(*args, **kwargs)
 File ""/Users//Documents/repos/test/.venv/lib/python3.8/site-packages/pandas/core/frame.py"", line 2836, in to_parquet
  return to_parquet(
 File ""/Users//Documents/repos/test/.venv/lib/python3.8/site-packages/pandas/io/parquet.py"", line 420, in to_parquet
  impl.write(
 File ""/Users//Documents/repos/test/.venv/lib/python3.8/site-packages/pandas/io/parquet.py"", line 195, in write
  self.api.parquet.write_table(
 File ""/Users//Documents/repos/test/.venv/lib/python3.8/site-packages/pyarrow/parquet.py"", line 1800, in write_table
  with ParquetWriter(
 File ""/Users//Documents/repos/test/.venv/lib/python3.8/site-packages/pyarrow/parquet.py"", line 633, in __init__
sink = self.file_handle = filesystem.open_output_stream(
 File ""pyarrow/_fs.pyx"", line 660, in pyarrow._fs.FileSystem.open_output_stream
 File ""pyarrow/error.pxi"", line 141, in pyarrow.lib.pyarrow_internal_check_status
 File ""pyarrow/error.pxi"", line 110, in pyarrow.lib.check_status
IsADirectoryError: [Errno 21] Failed to open local file 'datasets/'. Detail: [errno 21] Is a directory
```


### Expected Behavior

It should say
```
TypeError: __cinit__() got an unexpected keyword argument 'partitions_cols'
```

I get that error when I write this:

```
data_frame.to_parquet('temp.parquet', partitions_cols=cols_)
```

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit           : bb1f651536508cdfef8550f93ace7849b00046ee
python           : 3.8.2.final.0
python-bits      : 64
OS               : Darwin
OS-release       : 20.6.0
Version          : Darwin Kernel Version 20.6.0: Tue Oct 12 18:33:42 PDT 2021; root:xnu-7195.141.8~1/RELEASE_X86_64
machine          : x86_64
processor        : i386
byteorder        : little
LC_ALL           : None
LANG             : en_US.UTF-8
LOCALE           : en_US.UTF-8

pandas           : 1.4.0
numpy            : 1.22.2
pytz             : 2021.3
dateutil         : 2.8.2
pip              : 22.0.2
setuptools       : 41.2.0
Cython           : None
pytest           : 6.2.5
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : None
lxml.etree       : 4.6.4
html5lib         : None
pymysql          : 1.0.2
psycopg2         : None
jinja2           : 3.0.3
IPython          : 7.30.0
pandas_datareader: None
bs4              : 4.10.0
bottleneck       : None
fastparquet      : None
fsspec           : 2021.07.0
gcsfs            : None
matplotlib       : None
numba            : None
numexpr          : None
odfpy            : None
openpyxl         : 3.0.9
pandas_gbq       : None
pyarrow          : 4.0.0
pyreadstat       : None
pyxlsb           : None
s3fs             : 2021.08.0
scipy            : 1.7.3
sqlalchemy       : 1.3.18
tables           : None
tabulate         : None
xarray           : None
xlrd             : None
xlwt             : None
zstandard        : None

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45815/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45815/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45814,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45814/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45814/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45814/events,https://github.com/pandas-dev/pandas/issues/45814,1123735114,I_kwDOAA0YD85C-tZK,45814,BUG: Inaccuracy in groupby covariance when min_periods==ddof==2,"{'login': 'skirui-source', 'id': 71867292, 'node_id': 'MDQ6VXNlcjcxODY3Mjky', 'avatar_url': 'https://avatars.githubusercontent.com/u/71867292?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/skirui-source', 'html_url': 'https://github.com/skirui-source', 'followers_url': 'https://api.github.com/users/skirui-source/followers', 'following_url': 'https://api.github.com/users/skirui-source/following{/other_user}', 'gists_url': 'https://api.github.com/users/skirui-source/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/skirui-source/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/skirui-source/subscriptions', 'organizations_url': 'https://api.github.com/users/skirui-source/orgs', 'repos_url': 'https://api.github.com/users/skirui-source/repos', 'events_url': 'https://api.github.com/users/skirui-source/events{/privacy}', 'received_events_url': 'https://api.github.com/users/skirui-source/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2022-02-04T02:04:43Z,2022-02-04T02:06:45Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [ ] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
In [1]: import pandas as pd

In [2]: pdf = pd.DataFrame(
   ...:     {
   ...:         ""id"": [""a"", ""a"", ""b"", ""b"", ""c"", ""c""],
   ...:         ""val1"": [1.0, 2.0, 3.0, 4.0, 5.0, 6.0],
   ...:         ""val2"": pd.Series([None, None, None, None, None, None], dtype=float),
   ...:     }
   ...: )
   ...: pdf
Out[2]: 
  id val1  val2
0  a  1.0   NaN
1  a  2.0   NaN
2  b  3.0   NaN
3  b  4.0   NaN
4  c  5.0   NaN
5  c  6.0   NaN

In [3]: pdf.groupby(""id"").cov(min_periods=2, ddof=2)
Out[3]: 
        val1  val2
id                
a  val   0.5   NaN
   val1  NaN   NaN
b  val   0.5   NaN
   val1  NaN   NaN
c  val   0.5   NaN
   val1  NaN   NaN
```


### Issue Description

There's a bug in pandas when calculating the groupby covariance of  a DataFrame , with `min_periods== ddof == 2`. 
Issue exists in pandas v1.3.5

### Expected Behavior

The expected behavior is to return a DataFrame containing all `NaN `values:
```
Out[4]: 
         val1  val2
id                 
a  val   <NA>  <NA>
   val1  <NA>  <NA>
b  val   <NA>  <NA>
   val1  <NA>  <NA>
c  val   <NA>  <NA>
   val1  <NA>  <NA>

```

### Installed Versions

<details>

In [5]: pd.show_versions()

INSTALLED VERSIONS
------------------
commit           : 66e3805b8cabe977f40c05259cc3fcf7ead5687d
python           : 3.8.12.final.0
python-bits      : 64
OS               : Linux
OS-release       : 4.15.0-76-generic
Version          : #86-Ubuntu SMP Fri Jan 17 17:24:28 UTC 2020
machine          : x86_64
processor        : x86_64
byteorder        : little
LC_ALL           : None
LANG             : None
LOCALE           : en_US.UTF-8

pandas           : 1.3.5
numpy            : 1.21.5
pytz             : 2021.3
dateutil         : 2.8.2
pip              : 21.3.1
setuptools       : 59.8.0
Cython           : 0.29.26
pytest           : 6.2.5
hypothesis       : 6.36.0
sphinx           : 4.4.0
blosc            : None
feather          : None
xlsxwriter       : None
lxml.etree       : 4.7.1
html5lib         : None
pymysql          : None
psycopg2         : None
jinja2           : 3.0.3
IPython          : 8.0.1
pandas_datareader: None
bs4              : 4.10.0
bottleneck       : None
fsspec           : 2022.01.0
fastparquet      : None
gcsfs            : None
matplotlib       : None
numexpr          : None
odfpy            : None
openpyxl         : None
pandas_gbq       : None
pyarrow          : 5.0.0
pyxlsb           : None
s3fs             : None
scipy            : None
sqlalchemy       : None
tables           : None
tabulate         : None
xarray           : None
xlrd             : None
xlwt             : None
numba            : 0.55.0

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45814/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45814/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45813,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45813/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45813/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45813/events,https://github.com/pandas-dev/pandas/issues/45813,1123691019,I_kwDOAA0YD85C-ioL,45813,ENH: Show data types under column names,"{'login': 'pwwang', 'id': 1188067, 'node_id': 'MDQ6VXNlcjExODgwNjc=', 'avatar_url': 'https://avatars.githubusercontent.com/u/1188067?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/pwwang', 'html_url': 'https://github.com/pwwang', 'followers_url': 'https://api.github.com/users/pwwang/followers', 'following_url': 'https://api.github.com/users/pwwang/following{/other_user}', 'gists_url': 'https://api.github.com/users/pwwang/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/pwwang/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/pwwang/subscriptions', 'organizations_url': 'https://api.github.com/users/pwwang/orgs', 'repos_url': 'https://api.github.com/users/pwwang/repos', 'events_url': 'https://api.github.com/users/pwwang/events{/privacy}', 'received_events_url': 'https://api.github.com/users/pwwang/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,1,2022-02-04T00:32:53Z,2022-02-04T00:38:41Z,,NONE,,,,"#### Is your feature request related to a problem?


#### Describe the solution you'd like

Data types are shown directly in `R` under column names:

```R
# A tibble: 4 Ã— 2
      x     y
  <dbl> <int>
1     1     1
2     1     2
3     2     3
4     2     4
```

Wish pandas could have this feature as well.


#### API breaking implications



#### Describe alternatives you've considered

https://github.com/pwwang/pdtypes

| Turn this | into |
| --------- | ---- |
| ![terminal_without_pdtypes][1] | ![terminal_with_pdtypes][2] |
| ![terminal_without_pdtypes_gf][3] | ![terminal_with_pdtypes_gf][4] |
| ![notebook_without_pdtypes][5] | ![notebook_with_pdtypes][6] |
| ![notebook_without_pdtypes_gf][7] | ![notebook_with_pdtypes_gf][8] |

Just wondering if this is a welcome to become a PR.

#### Additional context

[1]: https://raw.githubusercontent.com/pwwang/pdtypes/master/docs/terminal_without_pdtypes.png
[2]: https://raw.githubusercontent.com/pwwang/pdtypes/master/docs/terminal_with_pdtypes.png
[3]: https://raw.githubusercontent.com/pwwang/pdtypes/master/docs/terminal_without_pdtypes_gf.png
[4]: https://raw.githubusercontent.com/pwwang/pdtypes/master/docs/terminal_with_pdtypes_gf.png
[5]: https://raw.githubusercontent.com/pwwang/pdtypes/master/docs/notebook_without_pdtypes.png
[6]: https://raw.githubusercontent.com/pwwang/pdtypes/master/docs/notebook_with_pdtypes.png
[7]: https://raw.githubusercontent.com/pwwang/pdtypes/master/docs/notebook_without_pdtypes_gf.png
[8]: https://raw.githubusercontent.com/pwwang/pdtypes/master/docs/notebook_with_pdtypes_gf.png
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45813/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45813/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45812,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45812/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45812/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45812/events,https://github.com/pandas-dev/pandas/pull/45812,1123634971,PR_kwDOAA0YD84yDfER,45812,TST: Create is_ci_environment helper,"{'login': 'mroeschke', 'id': 10647082, 'node_id': 'MDQ6VXNlcjEwNjQ3MDgy', 'avatar_url': 'https://avatars.githubusercontent.com/u/10647082?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/mroeschke', 'html_url': 'https://github.com/mroeschke', 'followers_url': 'https://api.github.com/users/mroeschke/followers', 'following_url': 'https://api.github.com/users/mroeschke/following{/other_user}', 'gists_url': 'https://api.github.com/users/mroeschke/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/mroeschke/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/mroeschke/subscriptions', 'organizations_url': 'https://api.github.com/users/mroeschke/orgs', 'repos_url': 'https://api.github.com/users/mroeschke/repos', 'events_url': 'https://api.github.com/users/mroeschke/events{/privacy}', 'received_events_url': 'https://api.github.com/users/mroeschke/received_events', 'type': 'User', 'site_admin': False}","[{'id': 127685, 'node_id': 'MDU6TGFiZWwxMjc2ODU=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Testing', 'name': 'Testing', 'color': 'C4A000', 'default': False, 'description': 'pandas testing functions or related to the test suite'}]",open,False,,[],,0,2022-02-03T22:53:12Z,2022-02-03T22:53:12Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/45812', 'html_url': 'https://github.com/pandas-dev/pandas/pull/45812', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/45812.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/45812.patch', 'merged_at': None}","- [ ] closes #xxxx (Replace xxxx with the Github issue number)
- [ ] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [ ] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [ ] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45812/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45812/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45811,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45811/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45811/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45811/events,https://github.com/pandas-dev/pandas/issues/45811,1123633107,I_kwDOAA0YD85C-UfT,45811,BUG: Merge inner join on index is working as left join for NaN,"{'login': 'hliatrussellinvestments', 'id': 70167716, 'node_id': 'MDQ6VXNlcjcwMTY3NzE2', 'avatar_url': 'https://avatars.githubusercontent.com/u/70167716?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/hliatrussellinvestments', 'html_url': 'https://github.com/hliatrussellinvestments', 'followers_url': 'https://api.github.com/users/hliatrussellinvestments/followers', 'following_url': 'https://api.github.com/users/hliatrussellinvestments/following{/other_user}', 'gists_url': 'https://api.github.com/users/hliatrussellinvestments/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/hliatrussellinvestments/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/hliatrussellinvestments/subscriptions', 'organizations_url': 'https://api.github.com/users/hliatrussellinvestments/orgs', 'repos_url': 'https://api.github.com/users/hliatrussellinvestments/repos', 'events_url': 'https://api.github.com/users/hliatrussellinvestments/events{/privacy}', 'received_events_url': 'https://api.github.com/users/hliatrussellinvestments/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,1,2022-02-03T22:50:09Z,2022-02-04T02:56:32Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
import pandas as pd

df_1 = pd.DataFrame({'a': [1,2,3,4,5],
                     'b': [1,2,None, 4, None],
                     'c': [1,2,3,4,5]}).set_index(['a', 'b'])

df_2 = pd.DataFrame({'a': [1,2,3,4,5],
                     'b': [1,2,3, 4, 5],
                     'c': [1,2,3,4,5]}).set_index(['a', 'b'])

df_merge = pd.merge(df_1, df_2, left_index=True, right_index=True, how='inner')
print(df_merge)
```


### Issue Description

When merging (inner) 2 data frames on index, if the left index contains NaN, then this row might stay in the result. As in the example above, the third row and last row from the left data frame stay in the merge result.

### Expected Behavior

I expect only 3 rows in the result. The third row and last row from the left data frame should not be in the result.

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit           : bb1f651536508cdfef8550f93ace7849b00046ee
python           : 3.8.6.final.0
python-bits      : 64
OS               : Windows
OS-release       : 10
Version          : 10.0.19041
machine          : AMD64
processor        : Intel64 Family 6 Model 158 Stepping 13, GenuineIntel
byteorder        : little
LC_ALL           : None
LANG             : None
LOCALE           : English_United States.1252
pandas           : 1.4.0
numpy            : 1.19.0
pytz             : 2021.3
dateutil         : 2.8.1
pip              : 21.3.1
setuptools       : 49.2.1
Cython           : None
pytest           : 5.4.1
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : None
lxml.etree       : None
html5lib         : None
pymysql          : None
psycopg2         : None
jinja2           : 2.11.1
IPython          : None
pandas_datareader: None
bs4              : None
bottleneck       : None
fastparquet      : None
fsspec           : 2021.10.0
gcsfs            : None
matplotlib       : None
numba            : None
numexpr          : None
odfpy            : None
openpyxl         : None
pandas_gbq       : None
pyarrow          : None
pyreadstat       : None
pyxlsb           : None
s3fs             : None
scipy            : 1.5.4
sqlalchemy       : 1.4.31
tables           : None
tabulate         : None
xarray           : None
xlrd             : None
xlwt             : None
zstandard        : None


</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45811/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45811/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45810,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45810/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45810/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45810/events,https://github.com/pandas-dev/pandas/issues/45810,1123573910,I_kwDOAA0YD85C-GCW,45810,BUG: `Float64` gets mixed with `np.nan` and cause `sum` to be `nan`,"{'login': 'ChiQiao', 'id': 35905338, 'node_id': 'MDQ6VXNlcjM1OTA1MzM4', 'avatar_url': 'https://avatars.githubusercontent.com/u/35905338?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/ChiQiao', 'html_url': 'https://github.com/ChiQiao', 'followers_url': 'https://api.github.com/users/ChiQiao/followers', 'following_url': 'https://api.github.com/users/ChiQiao/following{/other_user}', 'gists_url': 'https://api.github.com/users/ChiQiao/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/ChiQiao/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/ChiQiao/subscriptions', 'organizations_url': 'https://api.github.com/users/ChiQiao/orgs', 'repos_url': 'https://api.github.com/users/ChiQiao/repos', 'events_url': 'https://api.github.com/users/ChiQiao/events{/privacy}', 'received_events_url': 'https://api.github.com/users/ChiQiao/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 2822342, 'node_id': 'MDU6TGFiZWwyODIyMzQy', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Missing-data', 'name': 'Missing-data', 'color': 'd7e102', 'default': False, 'description': 'np.nan, pd.NaT, pd.NA, dropna, isnull, interpolate'}, {'id': 1817503692, 'node_id': 'MDU6TGFiZWwxODE3NTAzNjky', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/NA%20-%20MaskedArrays', 'name': 'NA - MaskedArrays', 'color': '8cc645', 'default': False, 'description': 'Related to pd.NA and nullable extension arrays'}]",open,False,,[],,4,2022-02-03T21:29:08Z,2022-02-03T22:44:07Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
import pandas as pd
a = pd.Series([0, np.nan], dtype=""float"")
b = pd.Series([0, 1], dtype=""Int64"")
(a * b).sum()
```


### Issue Description

According to https://pandas.pydata.org/docs/dev/user_guide/missing_data.html#calculations-with-missing-data, missing data should be treated as 0 when calculating the sum, while the code above yields `np.nan`. 

When constructing a `Series` with `dtype=""Float64""`, `np.nan` is converted to `pd.NA`. In the code above, the type of `a * b` is inferred as `Float64`, but `np.nan` persists. 

### Expected Behavior

returns 0

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit           : bb1f651536508cdfef8550f93ace7849b00046ee
python           : 3.9.10.final.0
python-bits      : 64
OS               : Windows
OS-release       : 10
Version          : 10.0.19043
machine          : AMD64
processor        : Intel64 Family 6 Model 142 Stepping 10, GenuineIntel
byteorder        : little
LC_ALL           : None
LANG             : en_US.UTF-8
LOCALE           : English_United States.1252

pandas           : 1.4.0
numpy            : 1.22.1
pytz             : 2021.3
dateutil         : 2.8.2
pip              : 22.0.2
setuptools       : 59.8.0
Cython           : None
pytest           : 6.2.5
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : 3.0.2
lxml.etree       : 4.7.1
html5lib         : None
pymysql          : 1.0.2
psycopg2         : None
jinja2           : 3.0.3
IPython          : 7.30.1
pandas_datareader: None
bs4              : 4.10.0
bottleneck       : None
fastparquet      : 0.8.0
fsspec           : 2021.11.1
gcsfs            : None
matplotlib       : 3.5.1
numba            : None
numexpr          : 2.7.3
odfpy            : None
openpyxl         : 3.0.9
pandas_gbq       : None
pyarrow          : 3.0.0
pyreadstat       : None
pyxlsb           : None
s3fs             : 0.4.2
scipy            : 1.7.3
sqlalchemy       : 1.4.31
tables           : 3.7.0
tabulate         : 0.8.9
xarray           : 0.21.1
xlrd             : 2.0.1
xlwt             : None
zstandard        : None

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45810/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45810/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45809,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45809/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45809/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45809/events,https://github.com/pandas-dev/pandas/issues/45809,1123551689,I_kwDOAA0YD85C-AnJ,45809,BUG: df.plot.scatter() with `norm` keyword fails with 'multiple values for keyword argument' TypeError,"{'login': 'Andy-Grigg', 'id': 6451062, 'node_id': 'MDQ6VXNlcjY0NTEwNjI=', 'avatar_url': 'https://avatars.githubusercontent.com/u/6451062?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/Andy-Grigg', 'html_url': 'https://github.com/Andy-Grigg', 'followers_url': 'https://api.github.com/users/Andy-Grigg/followers', 'following_url': 'https://api.github.com/users/Andy-Grigg/following{/other_user}', 'gists_url': 'https://api.github.com/users/Andy-Grigg/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/Andy-Grigg/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/Andy-Grigg/subscriptions', 'organizations_url': 'https://api.github.com/users/Andy-Grigg/orgs', 'repos_url': 'https://api.github.com/users/Andy-Grigg/repos', 'events_url': 'https://api.github.com/users/Andy-Grigg/events{/privacy}', 'received_events_url': 'https://api.github.com/users/Andy-Grigg/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2022-02-03T21:04:18Z,2022-02-03T21:04:58Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
import pandas as pd
import matplotlib

df = pd.DataFrame([{'1': 1.0, '2': 2.0, '3': 100},
                   {'1': 1.2, '2': 1.8, '3': 10}])

df.plot.scatter(x=""1"", y=""2"", c=""3"", norm=matplotlib.colors.LogNorm())
```


### Issue Description

The code above shows creating a DataFrame with three numeric columns, and then plotting the dataframe as a 2D scatter with a color axis based on one of the columns.

When running this code the following traceback is generated:

Traceback (most recent call last):
  File ""C:\ansysdev\pandas-bug.py"", line 7, in <module>
    df.plot.scatter(x=""1"", y=""2"", c=""3"", norm=matplotlib.colors.LogNorm())
  File ""C:\ansysdev\pandas-venv\lib\site-packages\pandas\plotting\_core.py"", line 1669, in scatter
    return self(kind=""scatter"", x=x, y=y, s=s, c=c, **kwargs)
  File ""C:\ansysdev\pandas-venv\lib\site-packages\pandas\plotting\_core.py"", line 917, in __call__
    return plot_backend.plot(data, x=x, y=y, kind=kind, **kwargs)
  File ""C:\ansysdev\pandas-venv\lib\site-packages\pandas\plotting\_matplotlib\__init__.py"", line 71, in plot
    plot_obj.generate()
  File ""C:\ansysdev\pandas-venv\lib\site-packages\pandas\plotting\_matplotlib\core.py"", line 329, in generate
    self._make_plot()
  File ""C:\ansysdev\pandas-venv\lib\site-packages\pandas\plotting\_matplotlib\core.py"", line 1119, in _make_plot
    scatter = ax.scatter(
TypeError: matplotlib.axes._axes.Axes.scatter() got multiple values for keyword argument 'norm'

### Expected Behavior

I believe the issue was caused by this PR: https://github.com/pandas-dev/pandas/pull/34293, specifically in this code block:

```python
        if color_by_categorical:
            from matplotlib import colors

            n_cats = len(self.data[c].cat.categories)
            cmap = colors.ListedColormap([cmap(i) for i in range(cmap.N)])
            bounds = np.linspace(0, n_cats, n_cats + 1)
            norm = colors.BoundaryNorm(bounds, cmap.N)
        else:
            norm = None
```

Since `color_by_categorical` is None, `norm` is being set to `None`. However, `norm` is also present in `self.kwds, which is where the 'multiple values for keyword argument' TypeError is coming from. The else branch should probably do something like:

`norm = self.kwds.pop('norm', None)`

This would result in the user's choice of `norm` being respected.

If the maintainers agree with this change, I'm happy to put together a PR with this in.

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit           : 7651c08230914ded8fceb93c990e2c859d51510d
python           : 3.10.0.final.0
python-bits      : 64
OS               : Windows
OS-release       : 10
Version          : 10.0.19042
machine          : AMD64
processor        : Intel64 Family 6 Model 85 Stepping 7, GenuineIntel
byteorder        : little
LC_ALL           : None
LANG             : None
LOCALE           : English_United States.1252

pandas           : 1.5.0.dev0+279.g7651c08230
numpy            : 1.22.1
pytz             : 2021.3
dateutil         : 2.8.2
pip              : 21.2.3
setuptools       : 57.4.0
Cython           : None
pytest           : None
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : None
lxml.etree       : None
html5lib         : None
pymysql          : None
psycopg2         : None
jinja2           : None
IPython          : None
pandas_datareader: None
bs4              : None
bottleneck       : None
fastparquet      : None
fsspec           : None
gcsfs            : None
matplotlib       : 3.5.1
numba            : None
numexpr          : None
odfpy            : None
openpyxl         : None
pandas_gbq       : None
pyarrow          : None
pyreadstat       : None
pyxlsb           : None
s3fs             : None
scipy            : None
sqlalchemy       : None
tables           : None
tabulate         : None
xarray           : None
xlrd             : None
xlwt             : None
zstandard        : None

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45809/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45809/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45808,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45808/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45808/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45808/events,https://github.com/pandas-dev/pandas/pull/45808,1123486238,PR_kwDOAA0YD84yC_kj,45808,bug: fix pd.NA in highlighters,"{'login': 'attack68', 'id': 24256554, 'node_id': 'MDQ6VXNlcjI0MjU2NTU0', 'avatar_url': 'https://avatars.githubusercontent.com/u/24256554?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/attack68', 'html_url': 'https://github.com/attack68', 'followers_url': 'https://api.github.com/users/attack68/followers', 'following_url': 'https://api.github.com/users/attack68/following{/other_user}', 'gists_url': 'https://api.github.com/users/attack68/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/attack68/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/attack68/subscriptions', 'organizations_url': 'https://api.github.com/users/attack68/orgs', 'repos_url': 'https://api.github.com/users/attack68/repos', 'events_url': 'https://api.github.com/users/attack68/events{/privacy}', 'received_events_url': 'https://api.github.com/users/attack68/received_events', 'type': 'User', 'site_admin': False}",[],open,False,,[],,0,2022-02-03T19:46:01Z,2022-02-03T19:46:01Z,,CONTRIBUTOR,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/45808', 'html_url': 'https://github.com/pandas-dev/pandas/pull/45808', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/45808.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/45808.patch', 'merged_at': None}","- [x] closes #45804
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45808/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45808/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45807,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45807/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45807/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45807/events,https://github.com/pandas-dev/pandas/issues/45807,1123477553,I_kwDOAA0YD85C9ugx,45807,BUG: ERROR building development env using Docker ,"{'login': 'NumberPiOso', 'id': 46936498, 'node_id': 'MDQ6VXNlcjQ2OTM2NDk4', 'avatar_url': 'https://avatars.githubusercontent.com/u/46936498?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/NumberPiOso', 'html_url': 'https://github.com/NumberPiOso', 'followers_url': 'https://api.github.com/users/NumberPiOso/followers', 'following_url': 'https://api.github.com/users/NumberPiOso/following{/other_user}', 'gists_url': 'https://api.github.com/users/NumberPiOso/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/NumberPiOso/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/NumberPiOso/subscriptions', 'organizations_url': 'https://api.github.com/users/NumberPiOso/orgs', 'repos_url': 'https://api.github.com/users/NumberPiOso/repos', 'events_url': 'https://api.github.com/users/NumberPiOso/events{/privacy}', 'received_events_url': 'https://api.github.com/users/NumberPiOso/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2022-02-03T19:35:01Z,2022-02-03T19:35:01Z,,CONTRIBUTOR,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
docker build --tag pandas-numberpioso-env .

ERROR: Command errored out with exit status 1: /opt/conda/bin/python -c 'import io, os, sys, setuptools, tokenize; sys.argv[0] = '""'""'/home/pandas/setup.py'""'""'; __file__='""'""'/home/pandas/setup.py'""'""';f = getattr(tokenize, '""'""'open'""'""', open)(__file__) if os.path.exists(__file__) else io.StringIO('""'""'from setuptools import setup; setup()'""'""');code = f.read().replace('""'""'\r\n'""'""', '""'""'\n'""'""');f.close();exec(compile(code, __file__, '""'""'exec'""'""'))' develop --no-deps Check the logs for full command output.


<details>
  Running setup.py develop for pandas
    ERROR: Command errored out with exit status 1:
     command: /opt/conda/bin/python -c 'import io, os, sys, setuptools, tokenize; sys.argv[0] = '""'""'/home/pandas/setup.py'""'""'; __file__='""'""'/home/pandas/setup.py'""'""';f = getattr(tokenize, '""'""'open'""'""', open)(__file__) if os.path.exists(__file__) else io.StringIO('""'""'from setuptools import setup; setup()'""'""');code = f.read().replace('""'""'\r\n'""'""', '""'""'\n'""'""');f.close();exec(compile(code, __file__, '""'""'exec'""'""'))' develop --no-deps
         cwd: /home/pandas/
    Complete output (25 lines):
    running develop
    running egg_info
    writing pandas.egg-info/PKG-INFO
    writing dependency_links to pandas.egg-info/dependency_links.txt
    writing entry points to pandas.egg-info/entry_points.txt
    writing requirements to pandas.egg-info/requires.txt
    writing top-level names to pandas.egg-info/top_level.txt
    reading manifest file 'pandas.egg-info/SOURCES.txt'
    reading manifest template 'MANIFEST.in'
    /tmp/pip-build-env-lkhctcw3/overlay/lib/python3.8/site-packages/setuptools/command/easy_install.py:157: EasyInstallDeprecationWarning: easy_install command is deprecated. Use build and pip and other standards-based tools.
      warnings.warn(
    /tmp/pip-build-env-lkhctcw3/overlay/lib/python3.8/site-packages/setuptools/command/install.py:34: SetuptoolsDeprecationWarning: setup.py install is deprecated. Use build and pip and other standards-based tools.
      warnings.warn(
    no previously-included directories found matching 'doc/build'
    warning: no previously-included files matching '*~' found anywhere in distribution
    warning: no previously-included files matching '.DS_Store' found anywhere in distribution
    warning: no previously-included files matching '#*' found anywhere in distribution
    warning: no previously-included files matching '*.py[ocd]' found anywhere in distribution
    adding license file 'LICENSE'
    running build_ext
    building 'pandas._libs.algos' extension
    /opt/conda/compiler_compat/ld: cannot find /lib64/libpthread.so.0
    /opt/conda/compiler_compat/ld: cannot find /usr/lib64/libpthread_nonshared.a
    collect2: error: ld returned 1 exit status
    error: command '/opt/conda/bin/gcc' failed with exit code 1
    ----------------------------------------
</details>
```


### Issue Description

Last command  `python -m pip install -e . ` at the Dockerfile fails:

https://github.com/pandas-dev/pandas/blob/5c757e9c4cf6a74fabfa1983dcd72b4759a88e5f/Dockerfile#L42-L48

Running manually those lines at docker image is successful until we arrive at this one
 `python -m pip install -e . `


### Expected Behavior

I would expect that the image should be successfully built

```bash
> docker build --tag pandas-numberpioso-env
Successfully built a3c5533304a3
Successfully tagged pandas-numberpioso-env:latest
```

### Installed Versions

<details>
INSTALLED VERSIONS
------------------
commit           : 5c757e9c4cf6a74fabfa1983dcd72b4759a88e5f
python           : 3.8.12.final.0
python-bits      : 64
OS               : Linux
OS-release       : 5.13.0-28-generic
Version          : #31~20.04.1-Ubuntu SMP Wed Jan 19 14:08:10 UTC 2022
machine          : x86_64
processor        : x86_64
byteorder        : little
LC_ALL           : None
LANG             : en_US.UTF-8
LOCALE           : en_US.UTF-8

pandas           : 1.5.0.dev0+277.g5c757e9c4c.dirty
numpy            : 1.19.4
pytz             : 2021.3
dateutil         : 2.8.2
pip              : 21.3.1
setuptools       : 59.8.0
Cython           : 0.29.26
pytest           : 6.2.5
hypothesis       : 6.36.0
sphinx           : 4.4.0
blosc            : None
feather          : None
xlsxwriter       : 3.0.2
lxml.etree       : 4.7.1
html5lib         : 1.1
pymysql          : None
psycopg2         : None
jinja2           : 2.11.3
IPython          : 8.0.1
pandas_datareader: None
bs4              : 4.10.0
bottleneck       : 1.3.2
fastparquet      : 0.7.2
fsspec           : 2021.11.0
gcsfs            : 2021.11.0
matplotlib       : 3.5.1
numba            : 0.55.0
numexpr          : 2.8.0
odfpy            : None
openpyxl         : 3.0.9
pandas_gbq       : None
pyarrow          : 6.0.1
pyreadstat       : 1.1.4
pyxlsb           : None
s3fs             : 2021.11.0
scipy            : 1.7.3
sqlalchemy       : 1.4.30
tables           : 3.6.1
tabulate         : 0.8.9
xarray           : 0.18.2
xlrd             : 2.0.1
xlwt             : 1.3.0
zstandard        : None


</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45807/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45807/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45806,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45806/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45806/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45806/events,https://github.com/pandas-dev/pandas/issues/45806,1123455893,I_kwDOAA0YD85C9pOV,45806,BUG: Cannot slice index using boolean type series,"{'login': 'ChiQiao', 'id': 35905338, 'node_id': 'MDQ6VXNlcjM1OTA1MzM4', 'avatar_url': 'https://avatars.githubusercontent.com/u/35905338?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/ChiQiao', 'html_url': 'https://github.com/ChiQiao', 'followers_url': 'https://api.github.com/users/ChiQiao/followers', 'following_url': 'https://api.github.com/users/ChiQiao/following{/other_user}', 'gists_url': 'https://api.github.com/users/ChiQiao/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/ChiQiao/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/ChiQiao/subscriptions', 'organizations_url': 'https://api.github.com/users/ChiQiao/orgs', 'repos_url': 'https://api.github.com/users/ChiQiao/repos', 'events_url': 'https://api.github.com/users/ChiQiao/events{/privacy}', 'received_events_url': 'https://api.github.com/users/ChiQiao/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2022-02-03T19:10:15Z,2022-02-03T19:10:15Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
import pandas as pd
s = pd.Series([True, False, pd.NA], dtype=""boolean"")
s.index[s]
```


### Issue Description

Get the following error: `ValueError: cannot convert to 'bool'-dtype NumPy array with missing values. Specify an appropriate 'na_value' for this dtype.`

### Expected Behavior

Returns `pd.Int64Index([0])`

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit           : bb1f651536508cdfef8550f93ace7849b00046ee
python           : 3.9.10.final.0
python-bits      : 64
OS               : Windows
OS-release       : 10
Version          : 10.0.19043
machine          : AMD64
processor        : Intel64 Family 6 Model 142 Stepping 10, GenuineIntel
byteorder        : little
LC_ALL           : None
LANG             : en_US.UTF-8
LOCALE           : English_United States.1252

pandas           : 1.4.0
numpy            : 1.22.1
pytz             : 2021.3
dateutil         : 2.8.2
pip              : 22.0.2
setuptools       : 59.8.0
Cython           : None
pytest           : 6.2.5
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : 3.0.2
lxml.etree       : 4.7.1
html5lib         : None
pymysql          : 1.0.2
psycopg2         : None
jinja2           : 3.0.3
IPython          : 7.30.1
pandas_datareader: None
bs4              : 4.10.0
bottleneck       : None
fastparquet      : 0.8.0
fsspec           : 2021.11.1
gcsfs            : None
matplotlib       : 3.5.1
numba            : None
numexpr          : 2.7.3
odfpy            : None
openpyxl         : 3.0.9
pandas_gbq       : None
pyarrow          : 3.0.0
pyreadstat       : None
pyxlsb           : None
s3fs             : 0.4.2
scipy            : 1.7.3
sqlalchemy       : 1.4.31
tables           : 3.7.0
tabulate         : 0.8.9
xarray           : 0.21.1
xlrd             : 2.0.1
xlwt             : None
zstandard        : None

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45806/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45806/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45805,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45805/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45805/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45805/events,https://github.com/pandas-dev/pandas/pull/45805,1123452871,PR_kwDOAA0YD84yC4k6,45805,"Backport PR #45786 on branch 1.4.x (TST: Skip flaky, crashing test in Windows)","{'login': 'meeseeksmachine', 'id': 39504233, 'node_id': 'MDQ6VXNlcjM5NTA0MjMz', 'avatar_url': 'https://avatars.githubusercontent.com/u/39504233?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/meeseeksmachine', 'html_url': 'https://github.com/meeseeksmachine', 'followers_url': 'https://api.github.com/users/meeseeksmachine/followers', 'following_url': 'https://api.github.com/users/meeseeksmachine/following{/other_user}', 'gists_url': 'https://api.github.com/users/meeseeksmachine/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/meeseeksmachine/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/meeseeksmachine/subscriptions', 'organizations_url': 'https://api.github.com/users/meeseeksmachine/orgs', 'repos_url': 'https://api.github.com/users/meeseeksmachine/repos', 'events_url': 'https://api.github.com/users/meeseeksmachine/events{/privacy}', 'received_events_url': 'https://api.github.com/users/meeseeksmachine/received_events', 'type': 'User', 'site_admin': False}","[{'id': 127685, 'node_id': 'MDU6TGFiZWwxMjc2ODU=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Testing', 'name': 'Testing', 'color': 'C4A000', 'default': False, 'description': 'pandas testing functions or related to the test suite'}, {'id': 57186974, 'node_id': 'MDU6TGFiZWw1NzE4Njk3NA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Windows', 'name': 'Windows', 'color': 'fbca04', 'default': False, 'description': 'Windows OS'}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/93', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/93', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/93/labels', 'id': 7593147, 'node_id': 'MI_kwDOAA0YD84Ac9y7', 'number': 93, 'title': '1.4.1', 'description': 'on-merge: backport to 1.4.x', 'creator': {'login': 'simonjayhawkins', 'id': 13159005, 'node_id': 'MDQ6VXNlcjEzMTU5MDA1', 'avatar_url': 'https://avatars.githubusercontent.com/u/13159005?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/simonjayhawkins', 'html_url': 'https://github.com/simonjayhawkins', 'followers_url': 'https://api.github.com/users/simonjayhawkins/followers', 'following_url': 'https://api.github.com/users/simonjayhawkins/following{/other_user}', 'gists_url': 'https://api.github.com/users/simonjayhawkins/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/simonjayhawkins/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/simonjayhawkins/subscriptions', 'organizations_url': 'https://api.github.com/users/simonjayhawkins/orgs', 'repos_url': 'https://api.github.com/users/simonjayhawkins/repos', 'events_url': 'https://api.github.com/users/simonjayhawkins/events{/privacy}', 'received_events_url': 'https://api.github.com/users/simonjayhawkins/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 7, 'closed_issues': 88, 'state': 'open', 'created_at': '2022-01-20T14:43:52Z', 'updated_at': '2022-02-03T19:06:40Z', 'due_on': '2022-02-12T08:00:00Z', 'closed_at': None}",0,2022-02-03T19:06:39Z,2022-02-03T19:06:40Z,,NONE,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/45805', 'html_url': 'https://github.com/pandas-dev/pandas/pull/45805', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/45805.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/45805.patch', 'merged_at': None}","Backport PR #45786: TST: Skip flaky, crashing test in Windows","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45805/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45805/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45804,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45804/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45804/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45804/events,https://github.com/pandas-dev/pandas/issues/45804,1123440142,I_kwDOAA0YD85C9lYO,45804,BUG: `styler` builtin highlighters and `pd.NA` interaction,"{'login': 'attack68', 'id': 24256554, 'node_id': 'MDQ6VXNlcjI0MjU2NTU0', 'avatar_url': 'https://avatars.githubusercontent.com/u/24256554?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/attack68', 'html_url': 'https://github.com/attack68', 'followers_url': 'https://api.github.com/users/attack68/followers', 'following_url': 'https://api.github.com/users/attack68/following{/other_user}', 'gists_url': 'https://api.github.com/users/attack68/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/attack68/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/attack68/subscriptions', 'organizations_url': 'https://api.github.com/users/attack68/orgs', 'repos_url': 'https://api.github.com/users/attack68/repos', 'events_url': 'https://api.github.com/users/attack68/events{/privacy}', 'received_events_url': 'https://api.github.com/users/attack68/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 2822342, 'node_id': 'MDU6TGFiZWwyODIyMzQy', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Missing-data', 'name': 'Missing-data', 'color': 'd7e102', 'default': False, 'description': 'np.nan, pd.NaT, pd.NA, dropna, isnull, interpolate'}, {'id': 1728592794, 'node_id': 'MDU6TGFiZWwxNzI4NTkyNzk0', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Styler', 'name': 'Styler', 'color': '006b75', 'default': False, 'description': 'conditional formatting using DataFrame.style'}]",open,False,,[],,0,2022-02-03T18:51:40Z,2022-02-03T18:56:55Z,,CONTRIBUTOR,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
.
```


### Issue Description

Styler has some defaults for display of ints and float. When including missing data this becomes a bit unintuitive:

When using `None` or `np.nan` the `int` column is cast to `float` and precision takes over:

```python
df = DataFrame([[1, 2], [3, None]])
df.style.highlight_max().highlight_null()
```
![Screen Shot 2022-02-03 at 19 27 25](https://user-images.githubusercontent.com/24256554/152405679-0cc694b1-f9c6-4c88-a0f7-ef41b49c2591.png)

This can be solved here by using `pd.NA` but this has the problem of casting the `int` col to `object` which has other implications, and dataframes probably don't want to be created like this in future:

```python
df = DataFrame([[1, 2], [3, pd.NA]])
df.style.highlight_max().highlight_null()
```
![Screen Shot 2022-02-03 at 19 31 25](https://user-images.githubusercontent.com/24256554/152406447-33467c93-366f-44d2-96cf-4968199765d5.png)

If instead we use the extension dtypes the column dtypes are consistently `int` but then the styling functions fail:

```python
df = DataFrame([[1, 2], [3, pd.NA]], dtype=""Int64"")
df.style.highlight_max().highlight_null()

<TypeError: boolean value of NA is ambiguous>
```


### Expected Behavior

It is reasonably simple to code a check for `pd.NA` in booleans and reallow the styling behaviour.

Might this be an appropriate solution or will pandas change the way `pd.NA` is interpreted in future?

### Installed Versions

.","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45804/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45804/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45803,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45803/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45803/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45803/events,https://github.com/pandas-dev/pandas/issues/45803,1123395837,I_kwDOAA0YD85C9aj9,45803,BUG: arithmetic operations disobey array priority,"{'login': 'FabianHofmann', 'id': 19226431, 'node_id': 'MDQ6VXNlcjE5MjI2NDMx', 'avatar_url': 'https://avatars.githubusercontent.com/u/19226431?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/FabianHofmann', 'html_url': 'https://github.com/FabianHofmann', 'followers_url': 'https://api.github.com/users/FabianHofmann/followers', 'following_url': 'https://api.github.com/users/FabianHofmann/following{/other_user}', 'gists_url': 'https://api.github.com/users/FabianHofmann/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/FabianHofmann/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/FabianHofmann/subscriptions', 'organizations_url': 'https://api.github.com/users/FabianHofmann/orgs', 'repos_url': 'https://api.github.com/users/FabianHofmann/repos', 'events_url': 'https://api.github.com/users/FabianHofmann/events{/privacy}', 'received_events_url': 'https://api.github.com/users/FabianHofmann/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,1,2022-02-03T18:01:42Z,2022-02-04T04:23:55Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [x] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
import pandas as pd
import numpy as np

class AlwaysOne(float):

    __array_priority__ = 10000
    __array_ufunc__ = None

    def __rmul__(self, other): 
        return 1

    def __mul__(self, other): 
        return 1
    
one = AlwaysOne()

# Test __mul__
print(one * 5) # returns 1
print(one * np.array([5,5])) # returns 1
print(one * pd.Series([5,5])) # returns 1

# Test __rmul__
print(5 * one) # returns 1
print(np.array([5,5]) * one) # returns 1
print(pd.Series([5,5]) * one) # returns pandas Series filled with ones.
```


### Issue Description

When multiplying a pandas.Series or a pandas.DataFrame with another object, a comparison of their  `__array_priority__`'s should determine which operation to choose: If the object on the left has a higher `__array_priority__` value, the  `__mul__` of this class is executed, if it stands on the right its `__rmul__` operation is executed.  

Pandas objects (Series & DataFrame) respect this rule however, they determine the output class when they stand left in the multiplication with an object of a higher `__array_priority__`. Note, this is not not the case for numpy arrays. 

### Expected Behavior

If the `__array_priority__` of the other class, which stands on the right side in the multiplication, is higher, the other class should determine the multiplication operation and thus the class of the result. 

### Installed Versions

<details>

NSTALLED VERSIONS
------------------
commit           : bb1f651536508cdfef8550f93ace7849b00046ee
python           : 3.9.9.final.0
python-bits      : 64
OS               : Linux
OS-release       : 5.13.0-27-generic
Version          : #29~20.04.1-Ubuntu SMP Fri Jan 14 00:32:30 UTC 2022
machine          : x86_64
processor        : x86_64
byteorder        : little
LC_ALL           : None
LANG             : en_US.UTF-8
LOCALE           : en_US.UTF-8

pandas           : 1.4.0
numpy            : 1.21.5
pytz             : 2021.3
dateutil         : 2.8.2
pip              : 21.3.1
setuptools       : 60.5.0
Cython           : None
pytest           : 6.2.5
hypothesis       : None
sphinx           : 4.3.2
blosc            : None
feather          : None
xlsxwriter       : None
lxml.etree       : None
html5lib         : None
pymysql          : None
psycopg2         : None
jinja2           : 3.0.3
IPython          : 7.29.0
pandas_datareader: None
bs4              : None
bottleneck       : 1.3.2
fastparquet      : None
fsspec           : 2022.01.0
gcsfs            : None
matplotlib       : 3.5.1
numba            : 0.55.0
numexpr          : 2.8.1
odfpy            : None
openpyxl         : None
pandas_gbq       : None
pyarrow          : None
pyreadstat       : None
pyxlsb           : None
s3fs             : None
scipy            : 1.7.3
sqlalchemy       : None
tables           : 3.7.0
tabulate         : 0.8.9
xarray           : 0.20.2
xlrd             : None
xlwt             : None
zstandard        : None
</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45803/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45803/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45802,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45802/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45802/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45802/events,https://github.com/pandas-dev/pandas/issues/45802,1123368164,I_kwDOAA0YD85C9Tzk,45802,BUG: Type error in groupby.transform(interpolate),"{'login': 'hliatrussellinvestments', 'id': 70167716, 'node_id': 'MDQ6VXNlcjcwMTY3NzE2', 'avatar_url': 'https://avatars.githubusercontent.com/u/70167716?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/hliatrussellinvestments', 'html_url': 'https://github.com/hliatrussellinvestments', 'followers_url': 'https://api.github.com/users/hliatrussellinvestments/followers', 'following_url': 'https://api.github.com/users/hliatrussellinvestments/following{/other_user}', 'gists_url': 'https://api.github.com/users/hliatrussellinvestments/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/hliatrussellinvestments/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/hliatrussellinvestments/subscriptions', 'organizations_url': 'https://api.github.com/users/hliatrussellinvestments/orgs', 'repos_url': 'https://api.github.com/users/hliatrussellinvestments/repos', 'events_url': 'https://api.github.com/users/hliatrussellinvestments/events{/privacy}', 'received_events_url': 'https://api.github.com/users/hliatrussellinvestments/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2022-02-03T17:31:52Z,2022-02-03T17:31:52Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
import numpy as np
import pandas as pd

np.random.seed(500)
test_df = pd.DataFrame({
    'a': np.random.randint(low=0, high=1000, size=10000),
    'b': np.random.choice([1, 2, 4, 7, np.nan], size=10000, p=([0.2475] * 4 + [0.01]))
})
test_df.groupby('a').transform(pd.DataFrame.interpolate)
```


### Issue Description

When I want to interpolation of some columns (column â€˜bâ€™ in example) in a data frame according to some other columns (column â€˜aâ€™ in example), I group by the accorded columns (column â€˜aâ€™ in example) and then transform the group using the interpolate method. 
It worked in version 1.1.1. 

### Expected Behavior

The nan values in column â€˜bâ€™ should be replaced by interpolated value according to column â€˜aâ€™. 

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit           : bb1f651536508cdfef8550f93ace7849b00046ee
python           : 3.8.6.final.0
python-bits      : 64
OS               : Windows
OS-release       : 10
Version          : 10.0.19041
machine          : AMD64
processor        : Intel64 Family 6 Model 158 Stepping 13, GenuineIntel
byteorder        : little
LC_ALL           : None
LANG             : None
LOCALE           : English_United States.1252
pandas           : 1.4.0
numpy            : 1.19.0
pytz             : 2021.3
dateutil         : 2.8.1
pip              : 21.3.1
setuptools       : 49.2.1
Cython           : None
pytest           : 5.4.1
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : None
lxml.etree       : None
html5lib         : None
pymysql          : None
psycopg2         : None
jinja2           : 2.11.1
IPython          : None
pandas_datareader: None
bs4              : None
bottleneck       : None
fastparquet      : None
fsspec           : 2021.10.0
gcsfs            : None
matplotlib       : None
numba            : None
numexpr          : None
odfpy            : None
openpyxl         : None
pandas_gbq       : None
pyarrow          : None
pyreadstat       : None
pyxlsb           : None
s3fs             : None
scipy            : 1.5.4
sqlalchemy       : 1.4.31
tables           : None
tabulate         : None
xarray           : None
xlrd             : None
xlwt             : None
zstandard        : None


</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45802/reactions', 'total_count': 1, '+1': 1, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45802/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45801,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45801/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45801/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45801/events,https://github.com/pandas-dev/pandas/issues/45801,1123345049,I_kwDOAA0YD85C9OKZ,45801,BUG: read_csv not applying dtype to index col when dtype is globally specified,"{'login': 'gaow', 'id': 917985, 'node_id': 'MDQ6VXNlcjkxNzk4NQ==', 'avatar_url': 'https://avatars.githubusercontent.com/u/917985?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/gaow', 'html_url': 'https://github.com/gaow', 'followers_url': 'https://api.github.com/users/gaow/followers', 'following_url': 'https://api.github.com/users/gaow/following{/other_user}', 'gists_url': 'https://api.github.com/users/gaow/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/gaow/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/gaow/subscriptions', 'organizations_url': 'https://api.github.com/users/gaow/orgs', 'repos_url': 'https://api.github.com/users/gaow/repos', 'events_url': 'https://api.github.com/users/gaow/events{/privacy}', 'received_events_url': 'https://api.github.com/users/gaow/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2022-02-03T17:09:49Z,2022-02-03T17:09:49Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
# Not expected behavior: index are still int
import pandas as pd
from io import StringIO
data = ""1,a\n2,b""
df = pd.read_csv(StringIO(data), index_col=0, dtype=str, header=None)
df.index
```


### Issue Description

This is separated from #44632. More discussions on #9435. In version 1.4.0 it does fix the case when dtype is defined for a column specifically:

```
df = pd.read_csv(StringIO(data), index_col=0, dtype={0:str}, header=None)
```

works. But not when you specify dtype globally.

### Expected Behavior

I expect by specifying `index_col=0, dtype=str` which requires all columns be `str`, then the first column is also a str and is used as index as well. With current version of pandas I am not sure what's the alternative implementation for my expected behavior. 

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit           : bb1f651536508cdfef8550f93ace7849b00046ee
python           : 3.8.5.final.0
python-bits      : 64
OS               : Linux
OS-release       : 5.4.0-39-generic
Version          : #43-Ubuntu SMP Fri Jun 19 10:28:31 UTC 2020
machine          : x86_64
processor        : x86_64
byteorder        : little
LC_ALL           : en_US.UTF-8
LANG             : en_US.UTF-8
LOCALE           : en_US.UTF-8

pandas           : 1.4.0
numpy            : 1.19.5
pytz             : 2020.5
dateutil         : 2.8.1
pip              : 20.2.4
setuptools       : 50.3.1.post20201107
Cython           : None
pytest           : 6.2.2
hypothesis       : None
sphinx           : 4.3.1
blosc            : None
feather          : 0.4.1
xlsxwriter       : None
lxml.etree       : 4.6.2
html5lib         : None
pymysql          : None
psycopg2         : None
jinja2           : 2.11.2
IPython          : 7.19.0
pandas_datareader: None
bs4              : 4.9.3
bottleneck       : None
fastparquet      : None
fsspec           : 0.8.5
gcsfs            : None
matplotlib       : 3.3.4
numba            : None
numexpr          : 2.7.2
odfpy            : None
openpyxl         : 3.0.9
pandas_gbq       : None
pyarrow          : 0.17.1
pyreadstat       : None
pyxlsb           : None
s3fs             : None
scipy            : 1.6.0
sqlalchemy       : 1.3.22
tables           : None
tabulate         : 0.8.7
xarray           : 0.16.2
xlrd             : 2.0.1
xlwt             : None
zstandard        : 0.15.1

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45801/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45801/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45800,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45800/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45800/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45800/events,https://github.com/pandas-dev/pandas/issues/45800,1123341073,I_kwDOAA0YD85C9NMR,45800,BUG: `df.agg` raises Exception on valid function in `df.apply`,"{'login': 'attack68', 'id': 24256554, 'node_id': 'MDQ6VXNlcjI0MjU2NTU0', 'avatar_url': 'https://avatars.githubusercontent.com/u/24256554?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/attack68', 'html_url': 'https://github.com/attack68', 'followers_url': 'https://api.github.com/users/attack68/followers', 'following_url': 'https://api.github.com/users/attack68/following{/other_user}', 'gists_url': 'https://api.github.com/users/attack68/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/attack68/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/attack68/subscriptions', 'organizations_url': 'https://api.github.com/users/attack68/orgs', 'repos_url': 'https://api.github.com/users/attack68/repos', 'events_url': 'https://api.github.com/users/attack68/events{/privacy}', 'received_events_url': 'https://api.github.com/users/attack68/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,1,2022-02-03T17:06:44Z,2022-02-03T20:01:48Z,,CONTRIBUTOR,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
.
```


### Issue Description

If the following `agg` is performed it currently works but gives a warning:

```python
df = pd.DataFrame({
    ""A"": Series((1000, 2000), dtype=int),
    ""B"": Series((1000, 2000), dtype=np.int64),
    ""C"": Series([""a"", ""b""]),
})

df.agg([""mean"", ""sum""])
           A       B    C
mean  1500.0  1500.0  NaN
sum   3000.0  3000.0   ab
```

`FutureWarning: ['C'] did not aggregate successfully. If any error is raised this will raise in a future version of pandas. Drop these columns/ops to avoid this warning. print(df.agg([""mean"", ""sum""]))`

However, I do not want to:

 - drop column `'C'`, because there is at least one op, `sum`, which produces a valid results for that column.
 - drop op `'mean'` because there is at least one column, `'A', 'B'`, which produce valid results for that op. 

I tried to design a function which would error trap this:

```python
def mean2(s:Series):
    try:
        ret = s.mean()
    except Exception:
        ret = pd.NA
    return ret

df.agg([mean2, ""sum""])
<ValueError: cannot combine transform and aggregation operations>
```

Oddly, this works with `apply` which is what the `agg` docs give guidance on:

```python
df.apply(mean2, axis=0)
A    1500.0
B    1500.0
C      <NA>
dtype: object
```

So what's the solution here?

### Expected Behavior

.

### Installed Versions

.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45800/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45800/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45798,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45798/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45798/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45798/events,https://github.com/pandas-dev/pandas/issues/45798,1123234911,I_kwDOAA0YD85C8zRf,45798,"BUG: `astype(""timedelta64[ns]"")` fails when `np.nan` is included","{'login': 'ChiQiao', 'id': 35905338, 'node_id': 'MDQ6VXNlcjM1OTA1MzM4', 'avatar_url': 'https://avatars.githubusercontent.com/u/35905338?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/ChiQiao', 'html_url': 'https://github.com/ChiQiao', 'followers_url': 'https://api.github.com/users/ChiQiao/followers', 'following_url': 'https://api.github.com/users/ChiQiao/following{/other_user}', 'gists_url': 'https://api.github.com/users/ChiQiao/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/ChiQiao/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/ChiQiao/subscriptions', 'organizations_url': 'https://api.github.com/users/ChiQiao/orgs', 'repos_url': 'https://api.github.com/users/ChiQiao/repos', 'events_url': 'https://api.github.com/users/ChiQiao/events{/privacy}', 'received_events_url': 'https://api.github.com/users/ChiQiao/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2022-02-03T15:36:47Z,2022-02-03T15:36:47Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
import pandas as pd
pd.Series([1, np.nan]).astype(""timedelta64[ns]"")
```


### Issue Description

Get an error `IntCastingNaNError: Cannot convert non-finite values (NA or inf) to integer`

### Expected Behavior

Cast `np.nan` as `pd.NaT`

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit           : bb1f651536508cdfef8550f93ace7849b00046ee
python           : 3.9.10.final.0
python-bits      : 64
OS               : Windows
OS-release       : 10
Version          : 10.0.19043
machine          : AMD64
processor        : Intel64 Family 6 Model 142 Stepping 10, GenuineIntel
byteorder        : little
LC_ALL           : None
LANG             : en_US.UTF-8
LOCALE           : English_United States.1252

pandas           : 1.4.0
numpy            : 1.22.1
pytz             : 2021.3
dateutil         : 2.8.2
pip              : 22.0.2
setuptools       : 59.8.0
Cython           : None
pytest           : 6.2.5
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : 3.0.2
lxml.etree       : 4.7.1
html5lib         : None
pymysql          : 1.0.2
psycopg2         : None
jinja2           : 3.0.3
IPython          : 7.30.1
pandas_datareader: None
bs4              : 4.10.0
bottleneck       : None
fastparquet      : 0.8.0
fsspec           : 2021.11.1
gcsfs            : None
matplotlib       : 3.5.1
numba            : None
numexpr          : 2.7.3
odfpy            : None
openpyxl         : 3.0.9
pandas_gbq       : None
pyarrow          : 3.0.0
pyreadstat       : None
pyxlsb           : None
s3fs             : 0.4.2
scipy            : 1.7.3
sqlalchemy       : 1.4.31
tables           : 3.7.0
tabulate         : 0.8.9
xarray           : 0.21.1
xlrd             : 2.0.1
xlwt             : None
zstandard        : None

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45798/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45798/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45797,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45797/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45797/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45797/events,https://github.com/pandas-dev/pandas/pull/45797,1122630691,PR_kwDOAA0YD84yALfv,45797,Test series replace different numpy int,"{'login': 'weikhor', 'id': 36619387, 'node_id': 'MDQ6VXNlcjM2NjE5Mzg3', 'avatar_url': 'https://avatars.githubusercontent.com/u/36619387?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/weikhor', 'html_url': 'https://github.com/weikhor', 'followers_url': 'https://api.github.com/users/weikhor/followers', 'following_url': 'https://api.github.com/users/weikhor/following{/other_user}', 'gists_url': 'https://api.github.com/users/weikhor/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/weikhor/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/weikhor/subscriptions', 'organizations_url': 'https://api.github.com/users/weikhor/orgs', 'repos_url': 'https://api.github.com/users/weikhor/repos', 'events_url': 'https://api.github.com/users/weikhor/events{/privacy}', 'received_events_url': 'https://api.github.com/users/weikhor/received_events', 'type': 'User', 'site_admin': False}",[],open,False,,[],,0,2022-02-03T04:08:23Z,2022-02-04T02:19:27Z,,CONTRIBUTOR,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/45797', 'html_url': 'https://github.com/pandas-dev/pandas/pull/45797', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/45797.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/45797.patch', 'merged_at': None}","- [âœ” ] closes #45311
- [âœ”] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [âœ”] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [X] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45797/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45797/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45796,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45796/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45796/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45796/events,https://github.com/pandas-dev/pandas/pull/45796,1122619570,PR_kwDOAA0YD84yAJPy,45796,BUG: Series[Interval].fillna(mismatched) coerce instead of raise,"{'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}",[],open,False,,[],,1,2022-02-03T03:43:09Z,2022-02-03T23:19:02Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/45796', 'html_url': 'https://github.com/pandas-dev/pandas/pull/45796', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/45796.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/45796.patch', 'merged_at': None}","- [ ] closes #xxxx (Replace xxxx with the Github issue number)
- [x] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [x] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [x] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.

Achieves consistency across methods in coercion behavior for IntervalDtype.","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45796/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45796/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45795,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45795/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45795/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45795/events,https://github.com/pandas-dev/pandas/pull/45795,1122618298,PR_kwDOAA0YD84yAI_r,45795,DEP: Protect some ExcelWriter attributes,"{'login': 'rhshadrach', 'id': 45562402, 'node_id': 'MDQ6VXNlcjQ1NTYyNDAy', 'avatar_url': 'https://avatars.githubusercontent.com/u/45562402?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/rhshadrach', 'html_url': 'https://github.com/rhshadrach', 'followers_url': 'https://api.github.com/users/rhshadrach/followers', 'following_url': 'https://api.github.com/users/rhshadrach/following{/other_user}', 'gists_url': 'https://api.github.com/users/rhshadrach/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/rhshadrach/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/rhshadrach/subscriptions', 'organizations_url': 'https://api.github.com/users/rhshadrach/orgs', 'repos_url': 'https://api.github.com/users/rhshadrach/repos', 'events_url': 'https://api.github.com/users/rhshadrach/events{/privacy}', 'received_events_url': 'https://api.github.com/users/rhshadrach/received_events', 'type': 'User', 'site_admin': False}","[{'id': 49254273, 'node_id': 'MDU6TGFiZWw0OTI1NDI3Mw==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/IO%20Excel', 'name': 'IO Excel', 'color': 'bfe5bf', 'default': False, 'description': 'read_excel, to_excel'}, {'id': 87485152, 'node_id': 'MDU6TGFiZWw4NzQ4NTE1Mg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Deprecate', 'name': 'Deprecate', 'color': '5319e7', 'default': False, 'description': 'Functionality to remove in pandas'}]",open,False,,[],,0,2022-02-03T03:39:54Z,2022-02-03T03:39:54Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/45795', 'html_url': 'https://github.com/pandas-dev/pandas/pull/45795', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/45795.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/45795.patch', 'merged_at': None}","- [x] closes #45572 (Replace xxxx with the Github issue number)
- [x] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [x] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [x] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.

Built on top of #45794

Any attributes we're looking to make protected are deprecated here, allowing users to use them until the next major release. Not deprecating any immutable attributes - users may find these useful and they do not require any extra care.

Docs for ExcelWriter are attached.
[excel_writer.pdf](https://github.com/pandas-dev/pandas/files/7991646/excel_writer.pdf)
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45795/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45795/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45794,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45794/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45794/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45794/events,https://github.com/pandas-dev/pandas/pull/45794,1122607485,PR_kwDOAA0YD84yAGz7,45794,BUG: Error writing an empty DataFrame to an ods file,"{'login': 'rhshadrach', 'id': 45562402, 'node_id': 'MDQ6VXNlcjQ1NTYyNDAy', 'avatar_url': 'https://avatars.githubusercontent.com/u/45562402?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/rhshadrach', 'html_url': 'https://github.com/rhshadrach', 'followers_url': 'https://api.github.com/users/rhshadrach/followers', 'following_url': 'https://api.github.com/users/rhshadrach/following{/other_user}', 'gists_url': 'https://api.github.com/users/rhshadrach/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/rhshadrach/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/rhshadrach/subscriptions', 'organizations_url': 'https://api.github.com/users/rhshadrach/orgs', 'repos_url': 'https://api.github.com/users/rhshadrach/repos', 'events_url': 'https://api.github.com/users/rhshadrach/events{/privacy}', 'received_events_url': 'https://api.github.com/users/rhshadrach/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 49254273, 'node_id': 'MDU6TGFiZWw0OTI1NDI3Mw==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/IO%20Excel', 'name': 'IO Excel', 'color': 'bfe5bf', 'default': False, 'description': 'read_excel, to_excel'}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/92', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/92', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/92/labels', 'id': 7530006, 'node_id': 'MI_kwDOAA0YD84AcuYW', 'number': 92, 'title': '1.5', 'description': '', 'creator': {'login': 'jreback', 'id': 953992, 'node_id': 'MDQ6VXNlcjk1Mzk5Mg==', 'avatar_url': 'https://avatars.githubusercontent.com/u/953992?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jreback', 'html_url': 'https://github.com/jreback', 'followers_url': 'https://api.github.com/users/jreback/followers', 'following_url': 'https://api.github.com/users/jreback/following{/other_user}', 'gists_url': 'https://api.github.com/users/jreback/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jreback/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jreback/subscriptions', 'organizations_url': 'https://api.github.com/users/jreback/orgs', 'repos_url': 'https://api.github.com/users/jreback/repos', 'events_url': 'https://api.github.com/users/jreback/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jreback/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 42, 'closed_issues': 247, 'state': 'open', 'created_at': '2021-12-31T21:51:13Z', 'updated_at': '2022-02-03T21:45:32Z', 'due_on': '2022-06-30T07:00:00Z', 'closed_at': None}",1,2022-02-03T03:14:44Z,2022-02-03T21:45:32Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/45794', 'html_url': 'https://github.com/pandas-dev/pandas/pull/45794', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/45794.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/45794.patch', 'merged_at': None}","- [x] closes #45793 (Replace xxxx with the Github issue number)
- [x] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [x] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [x] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45794/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45794/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45793,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45793/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45793/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45793/events,https://github.com/pandas-dev/pandas/issues/45793,1122602914,I_kwDOAA0YD85C6Y-i,45793,BUG: Error writing an empty DataFrame to an ods file,"{'login': 'rhshadrach', 'id': 45562402, 'node_id': 'MDQ6VXNlcjQ1NTYyNDAy', 'avatar_url': 'https://avatars.githubusercontent.com/u/45562402?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/rhshadrach', 'html_url': 'https://github.com/rhshadrach', 'followers_url': 'https://api.github.com/users/rhshadrach/followers', 'following_url': 'https://api.github.com/users/rhshadrach/following{/other_user}', 'gists_url': 'https://api.github.com/users/rhshadrach/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/rhshadrach/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/rhshadrach/subscriptions', 'organizations_url': 'https://api.github.com/users/rhshadrach/orgs', 'repos_url': 'https://api.github.com/users/rhshadrach/repos', 'events_url': 'https://api.github.com/users/rhshadrach/events{/privacy}', 'received_events_url': 'https://api.github.com/users/rhshadrach/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 49254273, 'node_id': 'MDU6TGFiZWw0OTI1NDI3Mw==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/IO%20Excel', 'name': 'IO Excel', 'color': 'bfe5bf', 'default': False, 'description': 'read_excel, to_excel'}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/92', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/92', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/92/labels', 'id': 7530006, 'node_id': 'MI_kwDOAA0YD84AcuYW', 'number': 92, 'title': '1.5', 'description': '', 'creator': {'login': 'jreback', 'id': 953992, 'node_id': 'MDQ6VXNlcjk1Mzk5Mg==', 'avatar_url': 'https://avatars.githubusercontent.com/u/953992?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jreback', 'html_url': 'https://github.com/jreback', 'followers_url': 'https://api.github.com/users/jreback/followers', 'following_url': 'https://api.github.com/users/jreback/following{/other_user}', 'gists_url': 'https://api.github.com/users/jreback/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jreback/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jreback/subscriptions', 'organizations_url': 'https://api.github.com/users/jreback/orgs', 'repos_url': 'https://api.github.com/users/jreback/repos', 'events_url': 'https://api.github.com/users/jreback/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jreback/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 42, 'closed_issues': 247, 'state': 'open', 'created_at': '2021-12-31T21:51:13Z', 'updated_at': '2022-02-03T21:45:32Z', 'due_on': '2022-06-30T07:00:00Z', 'closed_at': None}",0,2022-02-03T03:05:51Z,2022-02-03T21:45:24Z,,MEMBER,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
with pd.ExcelWriter('test.ods') as writer:
    DataFrame().to_excel(writer)
```


### Issue Description

Raises `ValueError: max() arg is an empty sequence`

### Expected Behavior

Write an empty sheet

### Installed Versions

<details>

Replace this line with the output of pd.show_versions()

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45793/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45793/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45790,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45790/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45790/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45790/events,https://github.com/pandas-dev/pandas/issues/45790,1122521511,I_kwDOAA0YD85C6FGn,45790,BUG: `df.to_hdf` fails when `DatetimeIndex` has `freq=pd.DateOffset(years=1)`,"{'login': 'ChiQiao', 'id': 35905338, 'node_id': 'MDQ6VXNlcjM1OTA1MzM4', 'avatar_url': 'https://avatars.githubusercontent.com/u/35905338?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/ChiQiao', 'html_url': 'https://github.com/ChiQiao', 'followers_url': 'https://api.github.com/users/ChiQiao/followers', 'following_url': 'https://api.github.com/users/ChiQiao/following{/other_user}', 'gists_url': 'https://api.github.com/users/ChiQiao/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/ChiQiao/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/ChiQiao/subscriptions', 'organizations_url': 'https://api.github.com/users/ChiQiao/orgs', 'repos_url': 'https://api.github.com/users/ChiQiao/repos', 'events_url': 'https://api.github.com/users/ChiQiao/events{/privacy}', 'received_events_url': 'https://api.github.com/users/ChiQiao/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2022-02-03T00:21:56Z,2022-02-03T00:21:56Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
import pandas as pd
df = pd.DataFrame({""a"": [0]}, index=pd.DatetimeIndex(['2020-01-01'], freq=pd.DateOffset(years=1)))
df.to_hdf(""foo.h5"", key=""data"")
```


### Issue Description

Get an error: `TypeError: `n` argument must be an integer, got <class 'pandas._libs.tslibs.offsets.DateOffset'>`

### Expected Behavior

Save the dataframe without an error.

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit           : bb1f651536508cdfef8550f93ace7849b00046ee
python           : 3.9.10.final.0
python-bits      : 64
OS               : Windows
OS-release       : 10
Version          : 10.0.19043
machine          : AMD64
processor        : Intel64 Family 6 Model 142 Stepping 10, GenuineIntel
byteorder        : little
LC_ALL           : None
LANG             : en_US.UTF-8
LOCALE           : English_United States.1252

pandas           : 1.4.0
numpy            : 1.22.1
pytz             : 2021.3
dateutil         : 2.8.2
pip              : 22.0.2
setuptools       : 59.8.0
Cython           : None
pytest           : 6.2.5
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : 3.0.2
lxml.etree       : 4.7.1
html5lib         : None
pymysql          : 1.0.2
psycopg2         : None
jinja2           : 3.0.3
IPython          : 7.30.1
pandas_datareader: None
bs4              : 4.10.0
bottleneck       : None
fastparquet      : 0.8.0
fsspec           : 2021.11.1
gcsfs            : None
matplotlib       : 3.5.1
numba            : None
numexpr          : 2.7.3
odfpy            : None
openpyxl         : 3.0.9
pandas_gbq       : None
pyarrow          : 3.0.0
pyreadstat       : None
pyxlsb           : None
s3fs             : 0.4.2
scipy            : 1.7.3
sqlalchemy       : 1.4.31
tables           : 3.7.0
tabulate         : 0.8.9
xarray           : 0.21.1
xlrd             : 2.0.1
xlwt             : None
zstandard        : None

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45790/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45790/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45789,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45789/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45789/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45789/events,https://github.com/pandas-dev/pandas/issues/45789,1122520108,I_kwDOAA0YD85C6Ews,45789,BUG: Date time slicing fails for `freq=pd.DateOffset(years=1)`,"{'login': 'ChiQiao', 'id': 35905338, 'node_id': 'MDQ6VXNlcjM1OTA1MzM4', 'avatar_url': 'https://avatars.githubusercontent.com/u/35905338?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/ChiQiao', 'html_url': 'https://github.com/ChiQiao', 'followers_url': 'https://api.github.com/users/ChiQiao/followers', 'following_url': 'https://api.github.com/users/ChiQiao/following{/other_user}', 'gists_url': 'https://api.github.com/users/ChiQiao/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/ChiQiao/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/ChiQiao/subscriptions', 'organizations_url': 'https://api.github.com/users/ChiQiao/orgs', 'repos_url': 'https://api.github.com/users/ChiQiao/repos', 'events_url': 'https://api.github.com/users/ChiQiao/events{/privacy}', 'received_events_url': 'https://api.github.com/users/ChiQiao/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2022-02-03T00:19:23Z,2022-02-03T00:19:23Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
import pandas as pd
df = pd.DataFrame({""a"": [0]}, index=pd.DatetimeIndex(['2020-01-01'], freq=pd.DateOffset(years=1)))
df.loc[""2020-01-01""]
```


### Issue Description

Get an error: `NotImplementedError: Prefix not defined`

### Expected Behavior

Should return the corresponding row just as `pd.DataFrame({""a"": [0]}, index=pd.DatetimeIndex(['2020-01-01'])).loc[""2020-01-01""]`. 

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit           : bb1f651536508cdfef8550f93ace7849b00046ee
python           : 3.9.10.final.0
python-bits      : 64
OS               : Windows
OS-release       : 10
Version          : 10.0.19043
machine          : AMD64
processor        : Intel64 Family 6 Model 142 Stepping 10, GenuineIntel
byteorder        : little
LC_ALL           : None
LANG             : en_US.UTF-8
LOCALE           : English_United States.1252

pandas           : 1.4.0
numpy            : 1.22.1
pytz             : 2021.3
dateutil         : 2.8.2
pip              : 22.0.2
setuptools       : 59.8.0
Cython           : None
pytest           : 6.2.5
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : 3.0.2
lxml.etree       : 4.7.1
html5lib         : None
pymysql          : 1.0.2
psycopg2         : None
jinja2           : 3.0.3
IPython          : 7.30.1
pandas_datareader: None
bs4              : 4.10.0
bottleneck       : None
fastparquet      : 0.8.0
fsspec           : 2021.11.1
gcsfs            : None
matplotlib       : 3.5.1
numba            : None
numexpr          : 2.7.3
odfpy            : None
openpyxl         : 3.0.9
pandas_gbq       : None
pyarrow          : 3.0.0
pyreadstat       : None
pyxlsb           : None
s3fs             : 0.4.2
scipy            : 1.7.3
sqlalchemy       : 1.4.31
tables           : 3.7.0
tabulate         : 0.8.9
xarray           : 0.21.1
xlrd             : 2.0.1
xlwt             : None
zstandard        : None


</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45789/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45789/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45787,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45787/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45787/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45787/events,https://github.com/pandas-dev/pandas/pull/45787,1122482728,PR_kwDOAA0YD84x_s-2,45787,BUG: loc raising uncontrolled error when more indexers than levels,"{'login': 'phofl', 'id': 61934744, 'node_id': 'MDQ6VXNlcjYxOTM0NzQ0', 'avatar_url': 'https://avatars.githubusercontent.com/u/61934744?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/phofl', 'html_url': 'https://github.com/phofl', 'followers_url': 'https://api.github.com/users/phofl/followers', 'following_url': 'https://api.github.com/users/phofl/following{/other_user}', 'gists_url': 'https://api.github.com/users/phofl/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/phofl/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/phofl/subscriptions', 'organizations_url': 'https://api.github.com/users/phofl/orgs', 'repos_url': 'https://api.github.com/users/phofl/repos', 'events_url': 'https://api.github.com/users/phofl/events{/privacy}', 'received_events_url': 'https://api.github.com/users/phofl/received_events', 'type': 'User', 'site_admin': False}","[{'id': 2822098, 'node_id': 'MDU6TGFiZWwyODIyMDk4', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Indexing', 'name': 'Indexing', 'color': '0b02e1', 'default': False, 'description': 'Related to indexing on series/frames, not to indexes themselves'}, {'id': 42670965, 'node_id': 'MDU6TGFiZWw0MjY3MDk2NQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Error%20Reporting', 'name': 'Error Reporting', 'color': 'ffa0ff', 'default': False, 'description': 'Incorrect or improved errors from pandas'}]",open,False,,[],,0,2022-02-02T23:14:44Z,2022-02-02T23:14:54Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/45787', 'html_url': 'https://github.com/pandas-dev/pandas/pull/45787', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/45787.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/45787.patch', 'merged_at': None}","- [x] closes #45762 (Replace xxxx with the Github issue number)
- [x] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [x] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [x] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45787/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45787/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45785,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45785/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45785/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45785/events,https://github.com/pandas-dev/pandas/pull/45785,1122424031,PR_kwDOAA0YD84x_gvd,45785,Regression: Loc raising when indexing mi with one level,"{'login': 'phofl', 'id': 61934744, 'node_id': 'MDQ6VXNlcjYxOTM0NzQ0', 'avatar_url': 'https://avatars.githubusercontent.com/u/61934744?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/phofl', 'html_url': 'https://github.com/phofl', 'followers_url': 'https://api.github.com/users/phofl/followers', 'following_url': 'https://api.github.com/users/phofl/following{/other_user}', 'gists_url': 'https://api.github.com/users/phofl/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/phofl/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/phofl/subscriptions', 'organizations_url': 'https://api.github.com/users/phofl/orgs', 'repos_url': 'https://api.github.com/users/phofl/repos', 'events_url': 'https://api.github.com/users/phofl/events{/privacy}', 'received_events_url': 'https://api.github.com/users/phofl/received_events', 'type': 'User', 'site_admin': False}","[{'id': 2822098, 'node_id': 'MDU6TGFiZWwyODIyMDk4', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Indexing', 'name': 'Indexing', 'color': '0b02e1', 'default': False, 'description': 'Related to indexing on series/frames, not to indexes themselves'}, {'id': 32815646, 'node_id': 'MDU6TGFiZWwzMjgxNTY0Ng==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Regression', 'name': 'Regression', 'color': 'e11d21', 'default': False, 'description': 'Functionality that used to work in a prior pandas version'}, {'id': 71268330, 'node_id': 'MDU6TGFiZWw3MTI2ODMzMA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/MultiIndex', 'name': 'MultiIndex', 'color': '207de5', 'default': False, 'description': None}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/93', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/93', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/93/labels', 'id': 7593147, 'node_id': 'MI_kwDOAA0YD84Ac9y7', 'number': 93, 'title': '1.4.1', 'description': 'on-merge: backport to 1.4.x', 'creator': {'login': 'simonjayhawkins', 'id': 13159005, 'node_id': 'MDQ6VXNlcjEzMTU5MDA1', 'avatar_url': 'https://avatars.githubusercontent.com/u/13159005?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/simonjayhawkins', 'html_url': 'https://github.com/simonjayhawkins', 'followers_url': 'https://api.github.com/users/simonjayhawkins/followers', 'following_url': 'https://api.github.com/users/simonjayhawkins/following{/other_user}', 'gists_url': 'https://api.github.com/users/simonjayhawkins/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/simonjayhawkins/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/simonjayhawkins/subscriptions', 'organizations_url': 'https://api.github.com/users/simonjayhawkins/orgs', 'repos_url': 'https://api.github.com/users/simonjayhawkins/repos', 'events_url': 'https://api.github.com/users/simonjayhawkins/events{/privacy}', 'received_events_url': 'https://api.github.com/users/simonjayhawkins/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 7, 'closed_issues': 88, 'state': 'open', 'created_at': '2022-01-20T14:43:52Z', 'updated_at': '2022-02-03T19:06:40Z', 'due_on': '2022-02-12T08:00:00Z', 'closed_at': None}",0,2022-02-02T21:51:56Z,2022-02-03T02:01:50Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/45785', 'html_url': 'https://github.com/pandas-dev/pandas/pull/45785', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/45785.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/45785.patch', 'merged_at': None}","- [x] closes #45779 (Replace xxxx with the Github issue number)
- [x] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [x] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [x] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.

@jbrockmendel You moved the error catching logic out of maybe_mi_droplevels. Is this necessary for one of the other code paths?","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45785/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45785/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45783,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45783/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45783/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45783/events,https://github.com/pandas-dev/pandas/issues/45783,1122369407,I_kwDOAA0YD85C5f9_,45783,BUG: Apply with one row unexpected behaviour - It sorts columns,"{'login': 'dglubokov', 'id': 40633356, 'node_id': 'MDQ6VXNlcjQwNjMzMzU2', 'avatar_url': 'https://avatars.githubusercontent.com/u/40633356?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/dglubokov', 'html_url': 'https://github.com/dglubokov', 'followers_url': 'https://api.github.com/users/dglubokov/followers', 'following_url': 'https://api.github.com/users/dglubokov/following{/other_user}', 'gists_url': 'https://api.github.com/users/dglubokov/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/dglubokov/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/dglubokov/subscriptions', 'organizations_url': 'https://api.github.com/users/dglubokov/orgs', 'repos_url': 'https://api.github.com/users/dglubokov/repos', 'events_url': 'https://api.github.com/users/dglubokov/events{/privacy}', 'received_events_url': 'https://api.github.com/users/dglubokov/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2022-02-02T20:44:01Z,2022-02-02T20:44:01Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the main branch of pandas.


### Reproducible Example

```python
import numpy as np
import pandas as pd


def main():
    def test(row):
        return {
            'Z': str(row['A']),
            'Y': '',
            'A': 'GCT',
            'B': ''
        }
    df = pd.DataFrame(np.random.randn(1, 4), columns=[""C1"", ""C2"", ""C3"", ""C4""])

    print(df.apply(test, axis=1, result_type='expand'))


main()
```


### Issue Description

```
     A B Y                    Z
0  GCT      -1.1154738837496128
```


You can see that columns was sorted. It's very unexpected, I think. I know that I should return list, but for readability I like use dict for return

### Expected Behavior

```
     Z                                    Y A     B
0  -1.1154738837496128   GCT     
```

It's should save columns order.

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit           : bb1f651536508cdfef8550f93ace7849b00046ee
python           : 3.9.9.final.0
python-bits      : 64
OS               : Darwin
OS-release       : 21.2.0
Version          : Darwin Kernel Version 21.2.0: Sun Nov 28 20:29:10 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T8101
machine          : arm64
processor        : arm
byteorder        : little
LC_ALL           : None
LANG             : en_GB.UTF-8
LOCALE           : en_GB.UTF-8

pandas           : 1.4.0
numpy            : 1.21.5
pytz             : 2021.1
dateutil         : 2.8.2
pip              : 21.3.1
setuptools       : 59.0.1
Cython           : None
pytest           : None
hypothesis       : None
sphinx           : None
blosc            : None
feather          : None
xlsxwriter       : None
lxml.etree       : 4.6.3
html5lib         : None
pymysql          : None
psycopg2         : None
jinja2           : 3.0.3
IPython          : 7.29.0
pandas_datareader: None
bs4              : 4.10.0
bottleneck       : None
fastparquet      : None
fsspec           : 0.9.0
gcsfs            : None
matplotlib       : 3.4.3
numba            : None
numexpr          : None
odfpy            : None
openpyxl         : 3.0.9
pandas_gbq       : None
pyarrow          : 6.0.1
pyreadstat       : None
pyxlsb           : None
s3fs             : None
scipy            : 1.7.3
sqlalchemy       : 1.4.28
tables           : None
tabulate         : 0.8.3
xarray           : 0.20.1
xlrd             : None
xlwt             : None
zstandard        : None

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45783/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45783/timeline,
https://api.github.com/repos/pandas-dev/pandas/issues/45780,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/45780/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/45780/comments,https://api.github.com/repos/pandas-dev/pandas/issues/45780/events,https://github.com/pandas-dev/pandas/pull/45780,1122160019,PR_kwDOAA0YD84x-pgA,45780,REF: Enhance consistency on Styler methods,"{'login': 'staticdev', 'id': 1446633, 'node_id': 'MDQ6VXNlcjE0NDY2MzM=', 'avatar_url': 'https://avatars.githubusercontent.com/u/1446633?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/staticdev', 'html_url': 'https://github.com/staticdev', 'followers_url': 'https://api.github.com/users/staticdev/followers', 'following_url': 'https://api.github.com/users/staticdev/following{/other_user}', 'gists_url': 'https://api.github.com/users/staticdev/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/staticdev/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/staticdev/subscriptions', 'organizations_url': 'https://api.github.com/users/staticdev/orgs', 'repos_url': 'https://api.github.com/users/staticdev/repos', 'events_url': 'https://api.github.com/users/staticdev/events{/privacy}', 'received_events_url': 'https://api.github.com/users/staticdev/received_events', 'type': 'User', 'site_admin': False}",[],open,False,,[],,3,2022-02-02T16:48:39Z,2022-02-03T12:18:55Z,,NONE,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/45780', 'html_url': 'https://github.com/pandas-dev/pandas/pull/45780', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/45780.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/45780.patch', 'merged_at': None}","- [x] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [x] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- Added an entry in the latest `doc/source/whatsnew/v1.4.1.rst` file if fixing a bug or adding a new feature. NOT NEEDED

pandas 1.4.0 introduces deprecation of `hide_columns()` and `hide_index()` in favor to `hide()`. Problem is the messages docstrings, parameters and warning messages pass parameters in different ways making it confusing and non-readable. This PR was created to address that and make all those consistent.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/45780/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/45780/timeline,
